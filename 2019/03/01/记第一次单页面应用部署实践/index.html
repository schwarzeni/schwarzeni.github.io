<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>è®°ç¬¬ä¸€æ¬¡å•é¡µé¢åº”ç”¨éƒ¨ç½²å®è·µ | Schwarzeni&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="å‰é¢æ²¡æœ‰è¿‡å•é¡µé¢å‰åç«¯åˆ†ç¦»çš„åº”ç”¨éƒ¨ç½²çš„ç»éªŒï¼›å°è¯•ç€è‡ªå·±éƒ¨ç½²äº†ä¸€ä¸‹ï¼Œé‡åˆ°äº†ä¸å°‘çš„é—®é¢˜ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹">
<meta name="keywords" content="æ€»ç»“,Linux">
<meta property="og:type" content="article">
<meta property="og:title" content="è®°ç¬¬ä¸€æ¬¡å•é¡µé¢åº”ç”¨éƒ¨ç½²å®è·µ">
<meta property="og:url" content="http://blog.schwarzeni.com/2019/03/01/è®°ç¬¬ä¸€æ¬¡å•é¡µé¢åº”ç”¨éƒ¨ç½²å®è·µ/index.html">
<meta property="og:site_name" content="Schwarzeni&#39;s blog">
<meta property="og:description" content="å‰é¢æ²¡æœ‰è¿‡å•é¡µé¢å‰åç«¯åˆ†ç¦»çš„åº”ç”¨éƒ¨ç½²çš„ç»éªŒï¼›å°è¯•ç€è‡ªå·±éƒ¨ç½²äº†ä¸€ä¸‹ï¼Œé‡åˆ°äº†ä¸å°‘çš„é—®é¢˜ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://blog.schwarzeni.com/2019/03/01/è®°ç¬¬ä¸€æ¬¡å•é¡µé¢åº”ç”¨éƒ¨ç½²å®è·µ/image1.png">
<meta property="og:image" content="http://blog.schwarzeni.com/2019/03/01/è®°ç¬¬ä¸€æ¬¡å•é¡µé¢åº”ç”¨éƒ¨ç½²å®è·µ/image2.png">
<meta property="og:image" content="http://blog.schwarzeni.com/2019/03/01/è®°ç¬¬ä¸€æ¬¡å•é¡µé¢åº”ç”¨éƒ¨ç½²å®è·µ/image3.png">
<meta property="og:updated_time" content="2019-06-19T00:52:41.355Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="è®°ç¬¬ä¸€æ¬¡å•é¡µé¢åº”ç”¨éƒ¨ç½²å®è·µ">
<meta name="twitter:description" content="å‰é¢æ²¡æœ‰è¿‡å•é¡µé¢å‰åç«¯åˆ†ç¦»çš„åº”ç”¨éƒ¨ç½²çš„ç»éªŒï¼›å°è¯•ç€è‡ªå·±éƒ¨ç½²äº†ä¸€ä¸‹ï¼Œé‡åˆ°äº†ä¸å°‘çš„é—®é¢˜ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹">
<meta name="twitter:image" content="http://blog.schwarzeni.com/2019/03/01/è®°ç¬¬ä¸€æ¬¡å•é¡µé¢åº”ç”¨éƒ¨ç½²å®è·µ/image1.png">
  
    <link rel="alternate" href="/atom.xml" title="Schwarzeni&#39;s blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/images/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  <!-- <link rel="stylesheet" href="/plugin/bganimation/bg.css"> -->
  

  <link rel="stylesheet" href="/third-party/powerful-sidebar-util/powerful-sidebar-util.css">
</head>

<body>
	<style>
		.main-folder {
			width: 100%;
			height: 100%;
			position: absolute;
			background-image: url("/blog/images/folder-pic.jpg") ;
			background-size: 100%;
			z-index: 100;
	
		}
	</style>
			<!--<div id="container" style="display: none"> -->
		<!--	<div class="main-folder" id="main_folder"> -->
		<!--	</div> -->
	<div id="container">
    <div id="wrap">
			<div class="outer">
        <div class="widget-wrap mobile-header">
  <h3 class="widget-title"></h3>
  <div class="widget">
    <img class="avatar" src="/images/avatar.jpg">
    <h2 class="author">Schwarzeni</h2>
    <h3 class="description"></h3>
    <div class="count-box">
      <a href="/archives"><div><strong>119</strong><br>æ–‡ç« </div></a>
      <a href="/categories"><div><strong>7</strong><br>åˆ†ç±»</div></a>
      <a href="/tags"><div><strong>50</strong><br>æ ‡ç­¾</div></a>
    </div>
    <ul class="blog-link">
     
          <a href="/" title="Home">
            <li>ä¸»é¡µ</li>
          </a>
        
          <a href="/archives" title="Archives">
            <li>å½’æ¡£</li>
          </a>
        
          <a href="/categories" title="Categories">
            <li>åˆ†ç±»</li>
          </a>
        
          <a href="/tags" title="Tags">
            <li>æ ‡ç­¾</li>
          </a>
        
          <a href="/plans" title="è¶³è¿¹">
            <li>è¶³è¿¹</li>
          </a>
        
          <a href="/about" title="About">
            <li>å…³äº</li>
          </a>
        
    </ul>
  </div>
</div>

        <section id="main"><article id="post-è®°ç¬¬ä¸€æ¬¡å•é¡µé¢åº”ç”¨éƒ¨ç½²å®è·µ" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/01/è®°ç¬¬ä¸€æ¬¡å•é¡µé¢åº”ç”¨éƒ¨ç½²å®è·µ/" class="article-date">
  <time class="post-time" datetime="2019-03-01T00:28:25.000Z" itemprop="datePublished">
    <span class="post-month">3æœˆ</span><br/>
    <span class="post-day">01</span>
  </time>
</a>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      è®°ç¬¬ä¸€æ¬¡å•é¡µé¢åº”ç”¨éƒ¨ç½²å®è·µ
    </h1>
  

        <div>
          
  <div class="article-category">
    <a class="article-category-link" href="/categories/æŠ€æœ¯/">æŠ€æœ¯</a>
  </div>

          
              

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>å‰é¢æ²¡æœ‰è¿‡å•é¡µé¢å‰åç«¯åˆ†ç¦»çš„åº”ç”¨éƒ¨ç½²çš„ç»éªŒï¼›å°è¯•ç€è‡ªå·±éƒ¨ç½²äº†ä¸€ä¸‹ï¼Œé‡åˆ°äº†ä¸å°‘çš„é—®é¢˜ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹</p>
<a id="more"></a>
<p>è‡ªå·±yyçš„æ¶æ„å›¾</p>
<p><img src="image1.png" alt=""></p>
<hr>
<h2 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h2><ul>
<li>å‰ç«¯æŠ€æœ¯æ ˆï¼šAngular v6.0.3ï¼ŒAngular Material v6.3.2</li>
<li>NodeJSæŠ€æœ¯æ ˆï¼šNodeJS v9.5.0ï¼ŒExpress v4.16.4ï¼Œpm2 v3.3.1</li>
<li>GoæŠ€æœ¯æ ˆï¼šGo v1.9ï¼Œgin v1.2</li>
<li>æœåŠ¡å™¨ï¼šCentOS7ï¼ŒNginx v1.12.2</li>
</ul>
<hr>
<h2 id="æ­å»ºNodejsä¸­è½¬æœåŠ¡å™¨"><a href="#æ­å»ºNodejsä¸­è½¬æœåŠ¡å™¨" class="headerlink" title="æ­å»ºNodejsä¸­è½¬æœåŠ¡å™¨"></a>æ­å»ºNodejsä¸­è½¬æœåŠ¡å™¨</h2><p>å¯¹Expressæ¯”è¾ƒç†Ÿæ‚‰ï¼Œä¸”å…¶ç”Ÿæ€åœˆéå¸¸å¥½ï¼Œæ‰€ä»¥å°±ä½¿ç”¨Expressä¸­è½¬æœåŠ¡å™¨ï¼ŒåŠŸèƒ½æœ‰ä¸‰</p>
<ul>
<li>å¤„ç†å‰ç«¯å•é¡µé¢åº”ç”¨è·¯ç”±Historyæ¨¡å¼</li>
<li>å¤„ç†é™æ€èµ„æºï¼šhtmlï¼Œcssï¼Œjsæ–‡ä»¶</li>
<li>å¯¹æ‰€æœ‰apiè¯·æ±‚è¿›è¡Œè½¬å‘</li>
</ul>
<p>éƒ¨ç½²è¦æœåŠ¡å™¨ä¸Šåä½¿ç”¨<a href="http://pm2.keymetrics.io/" target="_blank" rel="noopener">pm2</a>å¯åŠ¨å°±è¡Œ</p>
<p>å…³äºNodeJSç‰ˆæœ¬åˆ‡æ¢çš„é—®é¢˜ï¼Œä½¿ç”¨<a href="https://github.com/creationix/nvm" target="_blank" rel="noopener">nvm</a>å°±å¥½ï¼Œå®˜æ–¹çš„æ•™ç¨‹æ˜¯é è°±çš„ï¼Œåƒä¸‡ä¸è¦ç”¨<code>yum</code>æ¥å®‰è£…</p>
<p>å¤§ä½“çš„ç›®å½•ç»“æ„</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">middle_server</span><br><span class="line">â”œâ”€â”€ config              // å­˜æ”¾ä¸€äº›é…ç½®</span><br><span class="line">â”‚Â Â  â””â”€â”€ config.json</span><br><span class="line">â”œâ”€â”€ package.json</span><br><span class="line">â”œâ”€â”€ server.js           // æœåŠ¡å™¨ä¸»é€»è¾‘</span><br><span class="line">â””â”€â”€ static              // æ­¤å¤„å­˜æ”¾æ‰€æœ‰é™æ€èµ„æº</span><br><span class="line">    â”œâ”€â”€ assets</span><br><span class="line">    â”‚Â Â  â””â”€â”€ image</span><br><span class="line">    â”‚Â Â      â””â”€â”€ image.png</span><br><span class="line">    â”œâ”€â”€ index.html</span><br><span class="line">    â””â”€â”€ main.86479c8b865775dc42fc.js</span><br></pre></td></tr></table></figure>
<p>å®Œæˆéœ€æ±‚ä¸€ï¼Œéœ€è¦å®‰è£… <a href="https://github.com/bripkens/connect-history-api-fallback" target="_blank" rel="noopener">connect-history-api-fallback</a></p>
<p>å®Œæˆéœ€æ±‚äºŒï¼Œä½¿ç”¨<a href="https://expressjs.com/en/starter/static-files.html" target="_blank" rel="noopener">Expressæä¾›çš„api</a>å°±å¯ä»¥äº†ï¼Œå½“ç„¶ï¼Œç”±äºä½¿ç”¨å•é¡µé¢åº”ç”¨ï¼Œjsï¼Œcssæ–‡ä»¶ä¼šæ¯”è¾ƒå¤§ï¼Œå¦‚ä¸‹ï¼š</p>
<p><img src="image2.png" alt=""></p>
<p>æ‰€æœ‰è®°å¾—è®¾ç½®å®¢æˆ·ç«¯ç¼“å­˜ï¼Œ<a href="https://wdd.js.org/express-static-file-cache-setting-and-cleaning.html" target="_blank" rel="noopener">å¯ä»¥å‚è€ƒè¿™ä¸ªé“¾æ¥</a>ï¼Œå»ç›´æ¥çœ‹<a href="https://expressjs.com/en/resources/middleware/serve-static.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ä¹Ÿè¡Œã€‚</p>
<p>å½“ç„¶ï¼Œè®¾ç½®äº†ç¼“å­˜çš„è¯å°±åˆ«å¿˜äº†ç»™é™æ€èµ„æºæ–‡ä»¶åæˆ–è¯·æ±‚çš„urlæ‰“æ—¶é—´æˆ³ï¼Œä¸è¿‡è¿™ä¸ªåº”è¯¥æ˜¯å‰ç«¯åšçš„ï¼Œæ¯”å¦‚æˆ‘ä½¿ç”¨çš„Angularåœ¨æ‰“åŒ…çš„æ—¶å€™å·²ç»ä¸ºæ–‡ä»¶æ‰“ä¸Šæ—¶é—´æˆ³äº†ï¼Œè™½ç„¶æ¼äº†htmlå’Œå›¾ç‰‡æ–‡ä»¶â€¦.</p>
<p>å®Œæˆéœ€æ±‚ä¸‰ï¼Œéœ€è¦å®‰è£…<a href="https://github.com/villadora/express-http-proxy" target="_blank" rel="noopener">express-http-proxy</a>ï¼Œå½“ç„¶ï¼Œè‡ªå·±å®ç°ä¹Ÿå¯ä»¥ï¼Œå¯ä»¥<a href="https://stackoverflow.com/questions/10435407/proxy-with-express-js" target="_blank" rel="noopener">å‚çœ‹è¿™ç¯‡é—®ç­”</a>ï¼Œ</p>
<p>æ‰€æœ‰æœ€åserver.jsæ˜¯è¿™æ ·çš„ï¼Œè®°å¾—æœ€åæŠŠæ‰€æœ‰å¯æ›´æ”¹çš„æ•°å€¼å­˜æ”¾åˆ°jsonæ–‡ä»¶ä¸­æ–¹ä¾¿æ›´æ”¹ï¼Œæ¯”å¦‚ç›‘å¬çš„ç«¯å£</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"><span class="keyword">const</span> proxy = <span class="built_in">require</span>(<span class="string">'express-http-proxy'</span>)</span><br><span class="line"><span class="keyword">const</span> history = <span class="built_in">require</span>(<span class="string">'connect-history-api-fallback'</span>);</span><br><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">const</span> app = express()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> port = <span class="string">'4200'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸ºå‰ç«¯è·¯ç”±historyæ¨¡å¼è€Œé…ç½®</span></span><br><span class="line">app.use(history(&#123;</span><br><span class="line">  htmlAcceptHeaders: [<span class="string">'text/html'</span>]</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// é…ç½®é™æ€æ–‡ä»¶è·¯å¾„ï¼Œå¹¶è®¾ç½®æµè§ˆå™¨ç¼“å­˜æ—¶é—´ä¸º30å¤©</span></span><br><span class="line">app.use(<span class="string">'/'</span>, express.static(<span class="string">'static'</span>, &#123;<span class="attr">maxAge</span>: <span class="number">2592000000</span>&#125;))</span><br><span class="line"></span><br><span class="line"><span class="comment">// é…ç½®apiä»£ç†ï¼Œproxyåˆ°apiæœåŠ¡å™¨ä¸Š</span></span><br><span class="line">app.use(<span class="string">'/'</span>, proxy(<span class="string">'/'</span>,  &#123;</span><br><span class="line">  <span class="comment">// é…ç½®ä¸€äº›è¿‡æ»¤å™¨ .....</span></span><br><span class="line">  filter: <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯åŠ¨nodejsæœåŠ¡å™¨</span></span><br><span class="line">http.createServer(app)</span><br><span class="line">  .listen(port, () =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`font-end server is listening at port <span class="subst">$&#123;port&#125;</span>`</span>)</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="ç¼–è¯‘Golang"><a href="#ç¼–è¯‘Golang" class="headerlink" title="ç¼–è¯‘Golang"></a>ç¼–è¯‘Golang</h2><p>æœ¬åœ°ç¯å¢ƒæ˜¯MacOSï¼Œæˆ‘ä¸æƒ³æŠŠæ•´ä¸ªå·¥ç¨‹å¤–åŠ ä¾èµ–éƒ½æ‰“åŒ…æ”¾åˆ°æœåŠ¡å™¨ä¸Šï¼Œç„¶ååœ¨æœåŠ¡å™¨ä¸Šç¼–è¯‘ï¼›å¯å–œçš„æ˜¯Golangæ˜¯<a href="https://www.digitalocean.com/community/tutorials/how-to-build-go-executables-for-multiple-platforms-on-ubuntu-16-04" target="_blank" rel="noopener">æ”¯æŒå¤šå¹³å°ç¼–è¯‘çš„</a></p>
<p>æˆ‘çš„æœåŠ¡å™¨ç¯å¢ƒæ˜¯ CentOSï¼Œæ‰€ä»¥å°±ä¸€å¥å‘½ä»¤</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GOOS=linux GOARCH=amd64 go build -v /path/to/target/package</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="å…³äºMysql"><a href="#å…³äºMysql" class="headerlink" title="å…³äºMysql"></a>å…³äºMysql</h2><h3 id="å®‰è£…Mysql"><a href="#å®‰è£…Mysql" class="headerlink" title="å®‰è£…Mysql"></a>å®‰è£…Mysql</h3><p>è·Ÿç€è¿™ä¸ª<a href="https://www.digitalocean.com/community/tutorials/how-to-install-nginx-on-centos-7" target="_blank" rel="noopener">æ•™ç¨‹</a>ä¸€æ­¥ä¸€æ­¥æ¥å°±å¯ä»¥äº†</p>
<hr>
<h3 id="é‡ç½®å¯†ç "><a href="#é‡ç½®å¯†ç " class="headerlink" title="é‡ç½®å¯†ç "></a>é‡ç½®å¯†ç </h3><p>å”¯ä¸€è¦æ³¨æ„çš„æ˜¯ï¼Œå…³äºå®‰è£…å®Œæ¯•åæ›´æ”¹å¯†ç ï¼Œå¤§éƒ¨åˆ†ç»“æœæ–¹æ¡ˆéƒ½æ˜¯æŸ¥çœ‹Mysqlçš„è¾“å‡ºæ—¥å¿—æ‰¾å®ƒç”Ÿæˆçš„éšæœºå¯†ç ï¼Œä¹Ÿå°±æ˜¯è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo grep <span class="string">'temporary password'</span> /var/<span class="built_in">log</span>/mysqld.log</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæä¾›å¦ä¸€ç§æ–¹æ¡ˆï¼Œæ¥è‡ª<a href="https://stackoverflow.com/questions/33510184/change-mysql-root-password-on-centos7" target="_blank" rel="noopener">Change mysql root password on Centos7</a>ï¼Œæˆ‘å°±ç›´æ¥copyè¿‡æ¥äº†</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. Stop mysql:</span></span><br><span class="line">systemctl stop mysqld</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. Set the mySQL environment option</span></span><br><span class="line">systemctl <span class="built_in">set</span>-environment MYSQLD_OPTS=<span class="string">"--skip-grant-tables"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. Start mysql usig the options you just set</span></span><br><span class="line">systemctl start mysqld</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. Login as root</span></span><br><span class="line">mysql -u root</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. Update the root user password with these mysql commands</span></span><br><span class="line"><span class="comment"># å¦‚æœMysqlç‰ˆæœ¬å¤§äº5.7.6è¯·è¯·ä½¿ç”¨ä¸‹ä¸€æ¡è¯­å¥</span></span><br><span class="line">mysql&gt; UPDATE mysql.user SET authentication_string = PASSWORD(<span class="string">'MyNewPassword'</span>)</span><br><span class="line">    -&gt; WHERE User = <span class="string">'root'</span> AND Host = <span class="string">'localhost'</span>;</span><br><span class="line">mysql&gt; FLUSH PRIVILEGES;</span><br><span class="line">mysql&gt; quit</span><br><span class="line"></span><br><span class="line"><span class="comment"># As mentioned my shokulei in the comments, for 5.7.6 and later, you should use</span></span><br><span class="line">mysql&gt; ALTER USER <span class="string">'root'</span>@<span class="string">'localhost'</span> IDENTIFIED BY <span class="string">'MyNewPass'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. Stop mysql</span></span><br><span class="line">systemctl stop mysqld</span><br><span class="line"></span><br><span class="line"><span class="comment"># 7. Unset the mySQL envitroment option so it starts normally next time</span></span><br><span class="line">systemctl <span class="built_in">unset</span>-environment MYSQLD_OPTS</span><br><span class="line"></span><br><span class="line"><span class="comment"># 8. Start mysql normally:</span></span><br><span class="line">systemctl start mysqld</span><br><span class="line"></span><br><span class="line"><span class="comment"># Try to login using your new password:</span></span><br><span class="line">7. mysql -u root -p</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="ä¿®æ”¹é»˜è®¤ç¼–ç "><a href="#ä¿®æ”¹é»˜è®¤ç¼–ç " class="headerlink" title="ä¿®æ”¹é»˜è®¤ç¼–ç "></a>ä¿®æ”¹é»˜è®¤ç¼–ç </h3><p>å‚è€ƒè¿™ä¸ª<a href="https://stackoverflow.com/questions/3513773/change-mysql-default-character-set-to-utf-8-in-my-cnf" target="_blank" rel="noopener">é“¾æ¥</a>å°±okäº†ï¼Œå¤§ä½“çš„æˆ‘å°±ç›´æ¥copyè¿‡æ¥äº†</p>
<p>åœ¨my.cnfä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼Œè¿™ä¸ªæ–‡ä»¶ä¸å‡ºæ„å¤–çš„è¯åº”è¯¥æ˜¯åœ¨ <code>/etc/my.cnf</code> è·¯å¾„ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[client]</span><br><span class="line">default-character-set=utf8</span><br><span class="line"></span><br><span class="line">[mysql]</span><br><span class="line">default-character-set=utf8</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[mysqld]</span><br><span class="line">collation-server = utf8_unicode_ci</span><br><span class="line">init-connect=&apos;SET NAMES utf8&apos;</span><br><span class="line">character-set-server = utf8</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="å…³äºNginx"><a href="#å…³äºNginx" class="headerlink" title="å…³äºNginx"></a>å…³äºNginx</h2><h3 id="å®‰è£…Nginx"><a href="#å®‰è£…Nginx" class="headerlink" title="å®‰è£…Nginx"></a>å®‰è£…Nginx</h3><p>å‚è€ƒè¿™ä¸ª<a href="https://www.digitalocean.com/community/tutorials/how-to-install-nginx-on-centos-7" target="_blank" rel="noopener">é“¾æ¥</a>å°±å¯ä»¥äº†ï¼Œéå¸¸é è°±</p>
<hr>
<h3 id="æ‰“å¼€ç«¯å£"><a href="#æ‰“å¼€ç«¯å£" class="headerlink" title="æ‰“å¼€ç«¯å£"></a>æ‰“å¼€ç«¯å£</h3><p>æˆ‘å¸Œæœ›æŸ¥çœ‹è¿è¡Œåœ¨4200çš„NodeJSæœåŠ¡å™¨ï¼Œ8080çš„GoæœåŠ¡å™¨æ˜¯å¦å·²ç»è¿è¡ŒæˆåŠŸï¼Œå°±å¸Œæœ›è®¿é—®è¿™äº›ç«¯å£ï¼Œä½†æ˜¯CentOSé»˜è®¤éƒ½æ˜¯å…³é—­çš„ï¼Œéœ€è¦ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æ‰“å¼€ï¼Œ<a href="https://stackoverflow.com/questions/24729024/open-firewall-port-on-centos-7" target="_blank" rel="noopener">å‚è€ƒæ¥æº</a></p>
<p>å› ä¸ºhttp/httpsçš„ä¼ è¾“å±‚ç”¨çš„æ˜¯tcpï¼Œæ‰€ä»¥å°±ç›´æ¥å†™tcpäº†</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-port=4200/tcp --permanent</span><br><span class="line">firewall-cmd --zone=public --add-port=8080/tcp --permanent</span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure>
<p>è¾“å…¥å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹æ˜¯å¦å¼€æ”¾</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --list-ports</span><br></pre></td></tr></table></figure>
<p>åŒæ—¶ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹é‚£äº›ç«¯å£æœ‰ç¨‹åºç›‘å¬</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -ltnp</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p>é‡å¤´æˆå°±æ˜¯Nginxé…ç½®äº†ï¼Œå…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œåœ¨é…ç½®æ–‡ä»¶ <code>/etc/nginx/nginx/conf</code>ä¸­åŠ è¿™ä¹ˆä¸€æ®µå°±è¡Œäº†</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    server_name empmanage.schwarzeni.com;</span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://localhost:4200;</span><br><span class="line">        proxy_set_header Host $host:80;</span><br><span class="line">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">        proxy_cookie_path / /;</span><br><span class="line">    &#125;</span><br><span class="line">    listen 80;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>server_name å°±æ˜¯ä½ çš„åŸŸåï¼Œè¿™é‡Œæˆ‘è®¾äº†ä¸€ä¸ªäºŒçº§åŸŸå</p>
<p>å…³äºå‚æ•° <code>proxy_set_header</code>ï¼Œ<code>proxy_set_header</code>ï¼Œ<code>proxy_set_header</code>ï¼Œå‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š<a href="https://www.jianshu.com/p/9f21d24c0c4e" target="_blank" rel="noopener">nginx åå‘ä»£ç† ç«¯å£ é‡å®šå‘é—®é¢˜</a></p>
<p>è‡³äº <code>proxy_cookie_path</code>ï¼Œæ˜¯ä¸ºäº†é˜²æ­¢ <code>location</code> å’Œ <code>proxy_pass</code> çš„è·¯å¾„ä¸ä¸€å¯¼è‡´cookieä¸¢å¤±çš„é—®é¢˜</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">proxy_cookie_path off;</span><br><span class="line">proxy_cookie_path path replacement;</span><br></pre></td></tr></table></figure>
<p>è¯¦ç»†ä½¿ç”¨è¯·<a href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_cookie_path" target="_blank" rel="noopener">å‚è€ƒå®˜ç½‘</a>ï¼Œè¿™ç¯‡<a href="https://blog.csdn.net/isyoungboy/article/details/81382193" target="_blank" rel="noopener">åšæ–‡ï¼šè§£å†³nginx proxy_passåå‘ä»£ç†cookie,sessionä¸¢å¤±çš„é—®é¢˜</a> å†™çš„ä¹Ÿä¸é”™</p>
<hr>
<h3 id="Nginx502"><a href="#Nginx502" class="headerlink" title="Nginx502"></a>Nginx502</h3><p>è¿™ä¸ªå¤šåŠæ˜¯SELinuxçš„é—®é¢˜ï¼Œå‚è€ƒåšå®¢<a href="http://blog.codingplayboy.com/2017/05/22/nginx-502-bad-gateway/" target="_blank" rel="noopener">nginxåå‘ä»£ç†502-Bad Gatewayé—®é¢˜è§£å†³</a>çš„å†…å®¹è¾“å…¥å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/sbin/getsebool -a |grep httpd_can_network_connect</span><br></pre></td></tr></table></figure>
<p>å¦‚æœå¦‚ä¸‹è¾“å…¥ä¸º <code>off</code> åˆ™å°±æ˜¯å®ƒçš„é—®é¢˜</p>
<p><img src="image3.png" alt=""></p>
<p>è¾“å…¥å¦‚ä¸‹å‘½ä»¤å°±å¯ä»¥è§£å†³é—®é¢˜</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setsebool -P httpd_can_network_connect 1</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…<a href="https://blog.csdn.net/only_yu_yy/article/details/78825151" target="_blank" rel="noopener">ç›´æ¥å…³é—­SELinux</a></p>
<hr>
<h2 id="å…³äºRedis"><a href="#å…³äºRedis" class="headerlink" title="å…³äºRedis"></a>å…³äºRedis</h2><p>ç›´æ¥è·Ÿç€<a href="https://www.linode.com/docs/databases/redis/install-and-configure-redis-on-centos-7/" target="_blank" rel="noopener">æ•™ç¨‹1</a>æˆ–<a href="https://www.digitalocean.com/community/tutorials/how-to-install-secure-redis-centos-7" target="_blank" rel="noopener">æ•™ç¨‹2</a>æ¥å°±å¯ä»¥äº†</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.schwarzeni.com/2019/03/01/è®°ç¬¬ä¸€æ¬¡å•é¡µé¢åº”ç”¨éƒ¨ç½²å®è·µ/" data-id="cjzy6gjx800b4zivg3aza18hi" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/æ€»ç»“/">æ€»ç»“</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/03/04/æ­£åˆ™è¡¨è¾¾å¼å¤„ç†htmlæ ‡ç­¾/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          æ­£åˆ™è¡¨è¾¾å¼å¤„ç†htmlæ ‡ç­¾
        
      </div>
    </a>
  
  
    <a href="/2019/02/27/Javascriptä¸­çš„thisğŸ¹/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Javascriptä¸­çš„thisğŸ¹</div>
    </a>
  
</nav>

  
</article>









</section>
        
          <aside id="sidebar">
  
    <div class="widget-wrap">
  <h3 class="widget-title"></h3>
  <div class="widget">
    <h1 class="blog-title">Schwarzeni&#39;s blog</h1>
    <h2 class="blog-subtitle">Welcome to my secret garden</h2>
    <ul class="blog-link">
     
          <a href="/" title="Home">
            <li>ä¸»é¡µ</li>
          </a>
        
          <a href="/archives" title="Archives">
            <li>å½’æ¡£</li>
          </a>
        
          <a href="/categories" title="Categories">
            <li>åˆ†ç±»</li>
          </a>
        
          <a href="/tags" title="Tags">
            <li>æ ‡ç­¾</li>
          </a>
        
          <a href="/plans" title="è¶³è¿¹">
            <li>è¶³è¿¹</li>
          </a>
        
          <a href="/about" title="About">
            <li>å…³äº</li>
          </a>
        
    </ul>
  </div>
</div>

  
    <div class="widget-wrap">
  <h3 class="widget-title"></h3>
  <div class="widget">
    <img class="avatar" src="/images/avatar.jpg">
    <h2 class="author">Schwarzeni</h2>
    <h3 class="description"></h3>
    <div class="count-box">
      <a href="/archives"><div><strong>119</strong><br>æ–‡ç« </div></a>
      <a href="/categories"><div><strong>7</strong><br>åˆ†ç±»</div></a>
      <a href="/tags"><div><strong>50</strong><br>æ ‡ç­¾</div></a>
    </div>



    <div class="social-link">
      
        <a class="hvr-bounce-in" href="http://github.com/schwarzeni" target="_blank" title="Github">
          Github
        </a>
      
    </div>

    <div class="friend-link">
      <h2>å‹æƒ…é“¾æ¥</h2>
      
        <a class="hvr-bounce-in" href="https://blog.csdn.net/nzyalj" target="_blank" title="æ—§åšå®¢">
          æ—§åšå®¢
        </a>
      
    </div>
  </div>
</div>

  
</aside>

        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy;2018 - 2019 Schwarzeni<br>
      ç”±<a href="https://www.bilibili.com/bangumi/media/md9192" target="_blank">02Xå¹¿ä¸»å¸­</a>å¼ºåŠ›é©±åŠ¨ | 
      ä¸»é¢˜-<a href="https://github.com/ShanaMaid/hexo-theme-shana">hexo-theme-shana(éƒ¨åˆ†ä¿®æ”¹)</a>
      
    </div>
    
  </div>
</footer>

    </div>
    

<script src="/third-party/wow/jquery.min.js"></script>
<script src="/third-party/wow/wow.min.js"></script>
<script>
new WOW().init();
</script> 
<!-- ä¿®æ”¹æµ®åŠ¨å°æŒ‰é’® -->
<script src="/third-party/powerful-sidebar-util/lib/axios.min.js"></script>
<script src="/third-party/powerful-sidebar-util/powerful-sidebar-util.js"></script>


  <link rel="stylesheet" href="/plugin/fancybox/jquery.fancybox.css">
  <script src="/plugin/fancybox/jquery.fancybox.pack.js"></script>



  <link rel="stylesheet" href="/plugin/galmenu/GalMenu.css">
  <script src="/plugin/galmenu/GalMenu.js"></script>
  <div class="GalMenu GalDropDown">
      <div class="circle" id="gal">
        <div class="ring">
          
            <a href="/" title="" class="menuItem">é¦–é¡µ</a>
          
            <a href="/tags" title="" class="menuItem">æ ‡ç­¾</a>
          
            <a href="/categories" title="" class="menuItem">åˆ†ç±»</a>
          
            <a href="/archives" title="" class="menuItem">å½’æ¡£</a>
          
            <a href="/about" title="" class="menuItem">å…³äº</a>
          
        </div>
        
          <audio id="audio" src="#"></audio>
        
      </div> 
</div>
<div id="overlay" style="opacity: 1; cursor: pointer;"></div>
  <script type="text/javascript">var items = document.querySelectorAll('.menuItem');
    for (var i = 0,
    l = items.length; i < l; i++) {
      items[i].style.left = (50 - 35 * Math.cos( - 0.5 * Math.PI - 2 * (1 / l) * i * Math.PI)).toFixed(4) + "%";
      items[i].style.top = (50 + 35 * Math.sin( - 0.5 * Math.PI - 2 * (1 / l) * i * Math.PI)).toFixed(4) + "%"
    }</script>
<script type="text/javascript">
  $(document).ready(function() {
    $('body').GalMenu({
      'menu': 'GalDropDown'
    })
  });
</script>

  <!-- <section class="hidden-xs"> 
  <ul class="cb-slideshow"> 
    <li><span>æˆ‘</span></li> 
    <li><span>æ°¸</span></li> 
    <li><span>è¿œ</span></li> 
    <li><span>å–œ</span></li> 
    <li><span>æ¬¢</span></li> 
    <li><span>02</span></li> 
  </ul>
</section> -->

<script src="/js/script.js"></script>



<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>


  </div>
	<script>
	/*
		var host = "localhost:4000"
		var mainPageUrl = "http://" + host +"/blog";
		var $folder = document.getElementById('main_folder');
		var $main = document.getElementById('wrap');
		var $container = document.getElementById('container');
		if ( document.referrer.includes(host) || !(window.location.href === mainPageUrl || window.location.href === mainPageUrl + "/")) {
			$folder.style.display = "none";	
		} else {
			$main.style.display = "none";
		}
		$container.style = "";
		document.getElementById('go_to_main_page').onclick = function() {
			$folder.style.display = "none";	
			$main.style = "";
		}
*/
	</script>
</body>
</html>
